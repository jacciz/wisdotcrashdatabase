---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# wisdotcrashdatabase

<!-- badges: start -->
<!-- badges: end -->

The goal of wisdotcrashdatabase is to make data pulls and data analysis much easier in an R environment. To set up an R environment, you must convert the entire database into CSVs. I wrote automated scripts for these. Haven package is an option, but a couple things were not working properly. This package has functions to get certain crash flags, relabel by age or injury type for easier grouping.

## Installation

This package will never be released to CRAN as it's used internally at WisDOT.

The package can be installed from [GitHub](https://github.com/) with:

``` r
install.packages("devtools")
devtools::install_github("jacciz/wisdotcrashdatabase")
```
## Importing data

Old and new database data can be uploaded and imported via a single data frame. If new db is selected, then columns will have to be selected. Certain old db columns are renamed to match the new db. Import is done with one function:

```{r example}
library(wisdotcrashdatabase)

import_db_data(filepath = "C:/CSV/csv_from_sas/fst/", db_type = "crash", years_old = c("15", "16"), years = c("17","18")) %>% count(year(CRSHDATE))
```

## Crash flags
+ Deer 
+ Distracted driver 
+ Impaired driver 
+ Speed 
+ Teen driver 
+ Older driver_flag 
+ Seatbelt_flag_by_unit 
+ Suspected drug or alcohol 

## Relabel functions
+ Bin crash times 
+ Bin age groups 
+ Get county names based on cntycode 
+ Bin injures into Killed, Injured, No Injury 

```{r}
import_db_data(filepath = "C:/CSV/csv_from_sas/fst/", db_type = "person", years_old = c("16"), years = c("17","18")) %>% relabel_person_variables(relabel_by = "wisinj") %>% count(year(CRSHDATE), inj)
```




